# 主备Redis支持外网访问

主备版Redis目前支持一键配置外网IP地址。用户通过添加客户端IP地址实现外网白名单访问，添加完成后，即可通过公网访问实例进行请求

## 开启外网
1、用户选择需要开启外网的主备Redis实例，点击实例详情，在详情页的左边列表，可以看到访问能力的卡片，选择外网访问开关按钮

![image](/images/publicip01.png)

2、选择需要设置的外网带宽大小，带宽大小支持 1Mbps~10000Mbps，选择立即购买，用户可以在开启页面选择添加白名单列表，也可以完成开启后自行添加

![image](/images/publicip02.png)

3、按步骤开启成功后，在首页和实例详情页均能看到当前实例的外网IP地址

![image](/images/publicip03.png)

## 添加外网白名单
外网访问默认为白名单策略，用户需要把客户端公网IP地址添加到实例白名单列表

1、获取客户端的公网IP地址
- Linux/macOS 操作系统: 终端执行 curl ifconfig.me 获取本机公网IP地址
- Windows 操作系统: 终端执行 curl ip.me 获取本机公网IP地址

2、选择外网访问卡片的 白名单 编辑按钮，通过逗号分隔方式，支持批量添加外网IP和IP段地址
![image](/images/publicip04.png)
![image](/images/publicip05.png)

3、点击 保存 按钮，可以选择 redis-cli/telnet 等工具连接实例验证

4、客户如需增删白名单中的某个IP，需要通过设置最终的白名单列表来实现增减

5、如果用户实例当前已配置安全组，建议白名单列表设置为0.0.0.0/0全放行状态以避开冲突，可前往安全组控制台页面通过设置安全组规则来限制访问IP

## 调整外网带宽
用户可根据主备Redis实例详情页查看当前Redis的外网访问带宽大小，根据业务访问量按需调整当前实例的带宽大小
![image](/images/publicip08.png)
![image](/images/publicip06.png)

## 关闭外网
用户确认无业务通过公网访问Redis实例后，可选择关闭外网访问，关闭外网后，外网IP地址会被释放

![image](/images/publicip07.png)

## 计费
外网访问计费方式为带宽大小计费，带宽计费周期跟随实例计费周期，具体计费参考 ([外网带宽价格](https://docs.ucloud.cn/uredis/price?id=%e8%b7%a8%e5%9c%b0%e5%9f%9f%e5%a4%87%e4%bb%bd%e5%ad%98%e5%82%a8%e7%a9%ba%e9%97%b4%e8%b4%b9%e7%94%a8))

## 注意事项
- 实例购买的带宽为出带宽，即限制从云出到公网的带宽
- 外网带宽小于50Mbps时，该实例入口带宽等于50Mbps，大于50Mbps时，该实例入口带宽等于出口带宽
- 为保护您的实例安全，实例开启外网访问前请确保实例设置完成密码
- 实例发生容灾或者扩容迁移时，公网IP会出现短暂的不可用，恢复时间可能会滞后于内网IP地址的恢复可用时间
- 配置白名单时，空列表默认所有公网客户端均禁行，如配置列表包含0.0.0.0/0, 则所有公网客户端均可以访问实例



