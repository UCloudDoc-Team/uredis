## 数据分片管理

分布式Redis实例可以通过控制台详情-分片管理来管理集群的各个分片，可以查看集群实例的各个分片使用情况并进行单个分片管理监控，分片管理入口：
![image](/images/udredis202006001.png)

### 分片升降级

分布式Redis实例支持对单个分片进行配置升降级设置；如需对某一个分片进行升降级容量，可以选定该分片的操作项进行单个分片升降级：
![image](/images/udredis202006002.png)

注：在实际生产环境中，由于单个分片一旦内存使用量已满将会导致部分数据无法写入，因此，即使整个集群内存容量足够，但如果出现某个分片负载较高或内存使用率较高时，需要对该分片进行扩容操作。另外，建议用户使用中尽量使各个分片负载比较均衡，避免出现某个分片非常空闲造成资源浪费、而另外某个分片则负载严重。

在控制台上对分布式Redis分片进行升降级操作，如果分片类型是物理机类型，扩容时若宿主机资源充足不需要数据迁移；扩容时若宿主机资源不足则需要数据迁移，提示您对Redis影响如下：Redis升降级期间服务依然可用，但开始同步数据时负载会升高，并且主备切换时有20秒左右的闪断，请尽量在业务低峰期间执行。对于Redis缩容，整个过程中对Redis无任何影响。如果分片类型是快杰主机，扩容和缩容时，提示您对Redis影响如下：开始同步数据时负载会升高，并且主备切换时有20秒左右的闪断，请尽量在业务低峰期间执行。

### 分片监控管理
通过单个分片各自监控信息，可以掌握各个分片的负载情况，并根据需要有针对性对具体分片进行升级扩容等管理：
![image](/images/udredis202006003.png)
另外，单个分片默认接入“默认云内存存储告警模板”，当内存使用率达到告警模板中设置的阈值时，触发告警机制。
### 分片拆分操作

分布式版redis用户可以在分片管理页对分片节点进行拆分操作,可选择立即拆分和运维时间进行拆分：

![image](/images/udredis20211125001.png)
![image](/images/udredis20211125002.png)

### 集群规格调整
集群规格调整可以对集群的分片数量和单分片容量进行调整，调整完之后分片的计费方式采用NVMe版本分布式Redis价格，具体细节可以查看价格页面：[价格](/uredis/price)

#### 注意事项
1. 规格调整只有udredis类型的集群支持(slot范围是：0-131071)。
2. 规格调整需要满足当前集群总数据使用量小于要调整的目的规格的总容量。
3. 要有70%以上的分片的数据使用量小于4G，才允许做规格调整。
4. 如果原集群数据使用很不均衡，做集群规格调整选择的目标集群单节点容量需要谨慎，如果不确定是否可以做该项操作，请联系技术支持。

#### 控制台操作步骤
分布式redis的类型如果是udredis(slot范围是：0-131071)类型，可以在控制台修改集群的规格。
如下图所示：
![image](/images/cluster_upgrade_1.png)

点击修改集群规格之后选择要调整的目标集群分片数量和单分片容量：
![image](/images/cluster_upgrade_2.png)

点击“更改规格”可以在定时任务管理页面中看到该条任务。
![image](/images/cluster_upgrade_3.png)

任务状态变成“成功”表明任务执行完成，集群的规格已调整完成。
![image](/images/cluster_upgrade_4.png)

