## 数据回档

分布式Redis提供秒级的数据回档的功能，在开启了数据回档功能之后，您可以将实例整体的数据恢复到某个秒级的时间点（恢复到新实例）。数据回档拥有更加精细化的数据恢复的能力，能最大程度的保护您的数据安全。
目前支持数据回档的分布式实例版本为：4.0, 5.0, 6.0(部分老版本的分布式实例不支持开启)。

### 数据回档功能概述
为了保护您的业务数据，分布式版本的Redis支持数据回档的功能，原理是基于AOF（Append-only-file）的持久化机制，将AOF增量数据进行归档，可以实现秒级别的恢复，提升运维便捷性。

### 开启数据回档功能
![image](/images/cluster_aofrollback_open.png)
开启回档之后，可以看到整个集群的已使用空间和每个分片已使用的空间：
![image](/images/cluster_aofrollback_opened.png)

### 调整回档空间大小
当您的归档的AOF增量数据超过了所购买的指定大小时，老的AOF数据文件会被删除掉，所以为了您能够存储更多的数据大小，在空间不足时可以调整回档的存储空间大小。
![image](/images/cluster_aofrollback_resize1.png)
![image](/images/cluster_aofrollback_resize2.png)

### 选定指定时间进行回档
回档时，需要在“AOF秒级备份“页面点击"回档到新实例"，然后选择要回档的时间（可回档时间范围是：所有分片里最大的起始时间和最小的结束时间），如下图：
![image](/images/cluster_aofrollback_select1.png)
新的分布式实例规格的分片数量和源实例一致，单分片的容量是源实例容量最大的分片的容量。如下图所示（源实例分片数量是2，容量最大的是4G）：
![image](/images/cluster_aofrollback_select2.png)

## 使用注意事项
+ 由于回档是回档到新实例，所以回档时需要等待新实例创建完成，并且等待数据加载完成之后，此时回档的新实例才是可用状态。