# 代理选型

分布式版Redis目前创建页面支持主从型代理以及负载均衡型代理两种代理配置模式

## 主从型代理

### 特性
主从型代理通过主从模式保证代理的高可用服务，用户根据代理使用情况可以选择添加删除代理及扩容缩容代理来完成弹性拓展，在添加完成主从型代理后，分布式版Redis会额外提供一个ip入口，用户可以根据业务属性进行代理入口服务分配


### 注意事项
- 在删除主从型代理时，请确保业务不在使用该代理


## 负载均衡型代理

### 特性
负载均衡型代理采用报文转发型ULB+Proxy的架构，Proxy作为RServer节点提供服务，用户通过访问ULB提供的IP来使用Redis Proxy，客户端的连接会根据轮询的算法来选择Redis Proxy节点。每个代理节点采用单点模式，当某个节点发生故障，ULB会对该节点标记为异常下线，客户的请求会被转发至正常服务的Redis Proxy节点。


### 注意事项
- 使用了负载均衡代理之后，需要开启客户端的TCP keepalive
- 负载均衡型代理必须保证至少存在两个代理节点
- 目前只支持创建分布式集群时选择配置负载均衡型代理
- 报文转发型ULB的性能指标参考[这里](https://docs.ucloud.cn/ulb/intro/performance)
- 使用负载均衡型代理的集群额外收取2核费用作为ULB资源的费用([代理计费信息](https://docs.ucloud.cn/uredis/price?id=nvme%e6%88%96ssd%e5%88%86%e5%b8%83%e5%bc%8f%e7%89%88redis%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e5%9e%8b%e4%bb%a3%e7%90%86%e4%bb%b7%e6%a0%bc))



## 模式对比

- 主从型代理通过添加来提供多个ip服务入口，需要业务主动调整；负载均衡型代理模式统一ip入口，业务上使用更加简单
- 负载均衡型代理拓展上，受限于报文转发ULB的性能，主从型代理不受此限制
- 负载均衡型代理通过轮询的规则来分配连接，主从型代理请求可以由用户根据实际业务进行流量配置更加自由