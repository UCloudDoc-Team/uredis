# 跨地域备份

主备版URedis提供跨地域备份功能，支持将备份文件放到另一个地域存储。帮助用户提升监管与容灾恢复能力，同时提升数据的可靠性。 客户可以开启跨地域备份，关闭跨地域备份，设置目标地域备份文件的保留天数，查看跨地域已经备份的文件，下载备份文件以及从目标地域备份文件创建实例。

## 开启跨地域备份（源端）
开启跨地域备份之前，会先获取实例可以进行跨地域备份的目标地域， 用户可以开启跨地域备份功能，并设置需要备份的目标地域和保留天数(最低保留7天，最多保留5年)。 实例进行自动备份或者手动备份完成后， 跨地域备份逻辑会被触发， 将已经备份完成的文件备份到用户设置的目标地域， 目标地域中超过用户设置的保留时间的备份文件会被删除。
![image](/images/cross_backup_1.png)
![image](/images/cross_backup_2.png)

## 修改跨地域备份策略（源端）
用户在开启实例跨地域备份功能后， 可以选择修改跨地域备份策略，根据需要修改更改保留时间。若已存在的跨地域备份文件创建时间加上保留时间小于当前时间，跨地域备份文件将会触发过期删除。
![image](/images/cross_backup_6.png)

## 关闭跨地域备份（源端）
用户在开启实例跨地域备份功能后， 可以选择关闭跨地域备份功能， 需注意关闭跨地域备份功能不会删除已经备份的文件， 已经备份的文件会继续按照保留策略进行管理， 如用户不再需要备份文件， 可以先更改保留时间后， 再关闭跨地域备份功能。 删除实例目标地域的备份文件不会进行删除，扔按照保留天数进行保存，同时产生存储空间费用。
![image](/images/cross_backup_3.png)

## 查询跨地域备份文件（源端）
在实例自动备份或者手动备份完成后， 跨地域备份逻辑触发， 用户可以在实例的跨地域备份列表页以及目标地域的跨地域备份列表页查看相关的备份文件。
![image](/images/cross_backup_4.png)
![image](/images/cross_backup_5.png)

## 下载跨地域已备份文件
在目标地域， 如北京的实例设置跨地域备份到乌兰察布， 可以在乌兰察布的跨地域备份列表页查看已经备份的文件。 点击下载按钮后， 会返回文件的公网下载地址。
![image](/images/cross_backup_7.png)

## 从跨地域备份文件创建实例
在目标地域， 如北京的实例设置跨地域备份到乌兰察布， 可以在上海的跨地域备份列表页查看已经备份的文件。 点击从备份创建， 可以从备份创建一个新的实例， 需注意
1. 创建的实例除了使用原实例数据文件，和原实例没有其他联系
2. 创建的实例所属可用区为各个目标地域默认选区
3. 创建的实例容量规格需大于或等于原有规格
4. 创建的实例容量版本需大于或等于原有版本

![image](/images/cross_backup_8.png)

## 计费
跨地域备份功能将产生如下费用:
1. 网络流量费用: 网络流量费用是指从实例所在地域到备份目标地域产生的网络流量所产生的费用。 和备份文件的大小有关， 文件跨地域备份完成后，即进行计费， 备份文件大小不足1G将按照1GB进行计费。
2. 异地存储费用: 异地存储费用是指存储在目标地域的备份文件保存所产生的费用。跟备份总的大小有关， 每1个小时进行计费一次， 计算1小时平均存储量乘以周期1，存储量不足1GB将按照1GB进行计费。

更详细计费项如官网: https://docs.ucloud.cn/uredis/price
