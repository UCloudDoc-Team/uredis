# 内存分析


数据库自治中心内置Redis 内存分析功能，支持离线解析备份文件，可快速定位实例中的大 Key，精准呈现 Key 的内存占用、分布情况及过期时间等核心数据。该功能为 Redis 内存优化提供科学依据，助力规避因 Key 分布倾斜引发的内存不足、性能衰减等问题，保障实例稳定运行。


## 功能说明
- 内存分析功能基于Redis持久化策略RDB,现已支持Redis 7.0。
- 只支持分析Redis以下数据结构：String、Set、ZSet、Hash、List、Stream
- 如果目标实例规格已发生变更,分析结果会以当前实例规格为基准进行内存展示。如若需要准确的内存分析,请使用当前规格创建的备份文件。
- Redis内存分析结果仅保存7天，如需保存，请在分析详情页自行进行导出。

## 具体操作
点击“内存分析”进入操作页面
![image](/images/mem_analysis_1.png)

支持使用"历史备份"或"新建备份"。
![image](/images/mem_analysis_2.png)

若选择"新建备份",分析任务会在备份完成后再执行。若已存在备份/分析中任务,需等分析任务完成后才能重新创建分析任务。
![image](/images/mem_analysis_3.png)

分析详情可查询"任务概览"、"分析图"以及"分析表"
![image](/images/mem_analysis_4.png)
![image](/images/mem_analysis_5.png)
![image](/images/mem_analysis_6.png)

支持以csv格式导出分析表Top Key数据
![image](/images/mem_analysis_7.png)

## 常见问题
### 为什么内存分析结果展示的Key内存占有会比实际使用的内存小?
分析结果中实际只解析了Key和对应的Value在RDB中的占用大小,仅是use_memory中的一部分。
### 内存分析的前缀分隔符是什么？
Redis内存分析中的前缀分隔符会按照固定的前缀字符来区分Key,默认前缀分隔符集合为:;,_-+@=|#
### 为什么Top500 Key前缀分析中,string类型Key的数量和元素数量一样？
针对String类型的Key，其元素数量等同与Key数量。
### 为什么以"新建备份并使用"的分析方式创建任务提示失败？
该实例可能存在进行中备份任务,导致创建用于内存分析任务的备份失败。建议在业务低峰期新建备份,或使用历史备份进行分析。
